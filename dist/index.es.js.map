{"version":3,"file":"index.es.js","sources":["../src/lib/useYoutubeThumbnail.tsx","../src/lib/index.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\n\nexport type imgResolution =\n  | \"default\"\n  | \"mqdefault\"\n  | \"hqdefault\"\n  | \"sddefault\"\n  | \"maxresdefault\";\n\nconst expectedWidths: Record<imgResolution, number> = {\n  default: 120,\n  mqdefault: 320,\n  hqdefault: 480,\n  sddefault: 640,\n  maxresdefault: 1280,\n};\n\nexport const useYoutubeThumbnail = (\n  videoId: string,\n  vi: string,\n  format: string,\n  imageRes: imgResolution = \"maxresdefault\"\n) => {\n  const [url, setUrl] = useState(\"\");\n\n  useEffect(() => {\n    const testUrl = `https://img.youtube.com/${vi}/${videoId}/${imageRes}.${format}`;\n    const fallbackUrl = `https://img.youtube.com/${vi}/${videoId}/hqdefault.${format}`;\n\n    const expectedWidth = expectedWidths[imageRes];\n\n    const img = new Image();\n    img.onload = () => {\n      if (img.width < expectedWidth) {\n        setUrl(fallbackUrl);\n      } else {\n        setUrl(testUrl);\n      }\n    };\n    img.onerror = () => setUrl(fallbackUrl);\n    img.src = testUrl;\n  }, [videoId, vi, format, imageRes]);\n\n  return url;\n};\n\nexport default useYoutubeThumbnail;\n","import * as React from \"react\";\nimport useYoutubeThumbnail from \"./useYoutubeThumbnail\";\nimport { imgResolution } from \"./useYoutubeThumbnail\";\n\n// Re-export types for public API\nexport type { imgResolution };\n\n/**\n * YouTube Player State constants\n * @see https://developers.google.com/youtube/iframe_api_reference#onStateChange\n */\nexport enum PlayerState {\n  UNSTARTED = -1,\n  ENDED = 0,\n  PLAYING = 1,\n  PAUSED = 2,\n  BUFFERING = 3,\n  CUED = 5,\n}\n\n/**\n * YouTube Player Error codes\n * @see https://developers.google.com/youtube/iframe_api_reference#onError\n */\nexport enum PlayerError {\n  INVALID_PARAM = 2,\n  HTML5_ERROR = 5,\n  VIDEO_NOT_FOUND = 100,\n  NOT_EMBEDDABLE = 101,\n  NOT_EMBEDDABLE_DISGUISED = 150,\n}\n\n/**\n * YouTube Player Event data structure\n * Represents the data received from YouTube's postMessage API\n */\nexport interface YouTubeEvent {\n  info?: {\n    playerState?: PlayerState;\n    currentTime?: number;\n    duration?: number;\n    videoData?: {\n      video_id: string;\n      title: string;\n    };\n    playbackRate?: number;\n    playbackQuality?: string;\n  };\n}\n\n/**\n * Event handler for player state changes\n */\nexport interface PlayerStateChangeEvent {\n  state: PlayerState;\n  currentTime?: number;\n  duration?: number;\n}\n\n/**\n * Event handler for when player is ready\n */\nexport interface PlayerReadyEvent {\n  videoId: string;\n  title: string;\n}\n\n/**\n * SEO metadata for YouTube video following schema.org VideoObject structure.\n * See: https://developers.google.com/search/docs/appearance/structured-data/video\n *\n * All fields are optional but providing them improves search engine discoverability\n * and enables rich results (video carousels, thumbnails in search results).\n *\n * Use the provided `scripts/fetch-youtube-metadata.sh` helper to easily retrieve\n * this data from YouTube's API.\n */\nexport interface VideoSEO {\n  /**\n   * The title of the video. If not provided, falls back to the component's `title` prop.\n   * @example \"What's new in Material Design for the web\"\n   */\n  name?: string;\n\n  /**\n   * A description of the video content.\n   * Recommended: 50-160 characters for optimal search result display.\n   * @example \"Learn about the latest Material Design updates presented at Chrome Dev Summit 2019\"\n   */\n  description?: string;\n\n  /**\n   * ISO 8601 date when the video was uploaded to YouTube.\n   * @example \"2019-11-11T08:00:00Z\" or \"2019-11-11\"\n   */\n  uploadDate?: string;\n\n  /**\n   * ISO 8601 duration format. Required for video rich results.\n   * Format: PT#H#M#S where # is the number of hours, minutes, seconds\n   * @example \"PT1M33S\" (1 minute 33 seconds)\n   * @example \"PT15M\" (15 minutes)\n   * @example \"PT1H30M\" (1 hour 30 minutes)\n   */\n  duration?: string;\n\n  /**\n   * Custom thumbnail URL. If not provided, auto-generated from video ID.\n   * Recommended: At least 1200px wide for best quality in search results.\n   * @example \"https://i.ytimg.com/vi/VIDEO_ID/maxresdefault.jpg\"\n   */\n  thumbnailUrl?: string;\n\n  /**\n   * Direct URL to watch the video. Auto-generated if not provided.\n   * @example \"https://www.youtube.com/watch?v=L2vS_050c-M\"\n   */\n  contentUrl?: string;\n\n  /**\n   * The embed URL. Auto-generated from video ID if not provided.\n   * @example \"https://www.youtube.com/embed/L2vS_050c-M\"\n   */\n  embedUrl?: string;\n}\n\nexport interface LiteYouTubeProps {\n  announce?: string;\n  id: string;\n  title: string;\n  activatedClass?: string;\n  adNetwork?: boolean;\n  aspectHeight?: number;\n  aspectWidth?: number;\n  iframeClass?: string;\n  /** @deprecated Use cookie prop instead */\n  noCookie?: boolean;\n  cookie?: boolean;\n  enableJsApi?: boolean;\n  alwaysLoadIframe?: boolean;\n  params?: string;\n  playerClass?: string;\n  playlist?: boolean;\n  playlistCoverId?: string;\n  poster?: imgResolution;\n  webp?: boolean;\n  wrapperClass?: string;\n  onIframeAdded?: () => void;\n  muted?: boolean;\n  autoplay?: boolean;\n  thumbnail?: string;\n  rel?: string;\n  containerElement?: keyof React.JSX.IntrinsicElements;\n  style?: React.CSSProperties;\n  focusOnLoad?: boolean;\n  referrerPolicy?: React.HTMLAttributeReferrerPolicy;\n  /**\n   * Enable lazy loading for thumbnail image.\n   * Uses native browser lazy loading to defer offscreen images.\n   * Improves Lighthouse scores and reduces bandwidth for below-fold videos.\n   * @default false\n   */\n  lazyLoad?: boolean;\n  /**\n   * Stop video and return to thumbnail when playback ends.\n   * Prevents YouTube from showing related videos. Requires enableJsApi.\n   * @default false\n   */\n  stopOnEnd?: boolean;\n  /**\n   * SEO metadata for search engines. Enables rich results and better discoverability.\n   * Provides structured data following schema.org VideoObject specification.\n   * @see https://developers.google.com/search/docs/appearance/structured-data/video\n   */\n  seo?: VideoSEO;\n  /**\n   * Include noscript fallback link for accessibility and search crawlers.\n   * When true, adds a direct YouTube link inside <noscript> tags.\n   * @default true\n   */\n  noscriptFallback?: boolean;\n\n  // ==================== Player Event Handlers ====================\n\n  /**\n   * Fires when the player is ready and API is available.\n   * This is the first event to fire and indicates it's safe to call player methods.\n   * @param event - Contains video ID and title\n   * @example\n   * onReady={(event) => console.log('Player ready for:', event.videoId)}\n   */\n  onReady?: (event: PlayerReadyEvent) => void;\n\n  /**\n   * Fires when the player's state changes.\n   * Use this for comprehensive state tracking (play, pause, end, buffering, etc.)\n   * @param event - Contains state, current time, and duration\n   * @example\n   * onStateChange={(event) => {\n   *   if (event.state === PlayerState.PLAYING) {\n   *     analytics.track('video_play');\n   *   }\n   * }}\n   */\n  onStateChange?: (event: PlayerStateChangeEvent) => void;\n\n  /**\n   * Fires when the player encounters an error.\n   * Use this for graceful error handling and user feedback.\n   * @param errorCode - YouTube error code (see PlayerError enum)\n   * @example\n   * onError={(code) => {\n   *   if (code === PlayerError.VIDEO_NOT_FOUND) {\n   *     showErrorMessage('Video not available');\n   *   }\n   * }}\n   */\n  onError?: (errorCode: PlayerError) => void;\n\n  // ==================== Convenience Event Handlers ====================\n\n  /**\n   * Fires when the video starts playing.\n   * Convenience wrapper for onStateChange with PlayerState.PLAYING.\n   * @example\n   * onPlay={() => analytics.track('video_play')}\n   */\n  onPlay?: () => void;\n\n  /**\n   * Fires when the video is paused.\n   * Convenience wrapper for onStateChange with PlayerState.PAUSED.\n   * @example\n   * onPause={() => analytics.track('video_pause')}\n   */\n  onPause?: () => void;\n\n  /**\n   * Fires when the video ends.\n   * Convenience wrapper for onStateChange with PlayerState.ENDED.\n   * Useful for loading next video in a playlist.\n   * @example\n   * onEnd={() => loadNextVideo()}\n   */\n  onEnd?: () => void;\n\n  /**\n   * Fires when the video is buffering.\n   * Convenience wrapper for onStateChange with PlayerState.BUFFERING.\n   * @example\n   * onBuffering={() => showLoadingSpinner()}\n   */\n  onBuffering?: () => void;\n\n  // ==================== Advanced Event Handlers ====================\n\n  /**\n   * Fires when the playback rate (speed) changes.\n   * Common values: 0.25, 0.5, 1, 1.5, 2\n   * @param playbackRate - The new playback rate\n   * @example\n   * onPlaybackRateChange={(rate) => console.log('Speed:', rate + 'x')}\n   */\n  onPlaybackRateChange?: (playbackRate: number) => void;\n\n  /**\n   * Fires when the video quality changes.\n   * Common values: \"small\" (240p), \"medium\" (360p), \"large\" (480p), \"hd720\", \"hd1080\"\n   * @param quality - The new quality level\n   * @example\n   * onPlaybackQualityChange={(quality) => {\n   *   analytics.track('quality_change', { quality });\n   * }}\n   */\n  onPlaybackQualityChange?: (quality: string) => void;\n}\n\n/**\n * Generates JSON-LD structured data for VideoObject schema.\n * @see https://schema.org/VideoObject\n * @see https://developers.google.com/search/docs/appearance/structured-data/video\n */\nfunction generateVideoStructuredData(\n  videoId: string,\n  title: string,\n  posterUrl: string,\n  ytUrl: string,\n  seo?: VideoSEO\n): string {\n  const structuredData = {\n    \"@context\": \"https://schema.org\",\n    \"@type\": \"VideoObject\",\n    name: seo?.name || title,\n    thumbnailUrl: [seo?.thumbnailUrl || posterUrl],\n    embedUrl: seo?.embedUrl || `${ytUrl}/embed/${videoId}`,\n    contentUrl: seo?.contentUrl || `https://www.youtube.com/watch?v=${videoId}`,\n    ...(seo?.description && { description: seo.description }),\n    ...(seo?.uploadDate && { uploadDate: seo.uploadDate }),\n    ...(seo?.duration && { duration: seo.duration }),\n  };\n\n  return JSON.stringify(structuredData);\n}\n\nfunction LiteYouTubeEmbedComponent(\n  props: LiteYouTubeProps,\n  ref: React.Ref<HTMLIFrameElement>\n) {\n  const [preconnected, setPreconnected] = React.useState(false);\n  const [iframe, setIframe] = React.useState(props.alwaysLoadIframe || false);\n  const videoId = encodeURIComponent(props.id);\n  const videoPlaylistCoverId =\n    typeof props.playlistCoverId === \"string\"\n      ? encodeURIComponent(props.playlistCoverId)\n      : null;\n  const videoTitle = props.title;\n  const posterImp = props.poster || \"hqdefault\";\n  const announceWatch = props.announce || \"Watch\";\n\n  const shouldAddAutoplayParam = props.alwaysLoadIframe\n    ? props.autoplay && props.muted\n    : true; // When the iframe is not loaded immediately, the video should play as soon as its loaded (which happens when the button is clicked)\n\n  // Iframe Parameters - memoized to avoid recreating URLSearchParams on every render\n  const iframeParams = React.useMemo(() => {\n    const params = new URLSearchParams({\n      ...(props.muted ? { mute: \"1\" } : {}),\n      ...(shouldAddAutoplayParam ? { autoplay: \"1\" } : {}),\n      ...(props.enableJsApi ? { enablejsapi: \"1\" } : {}),\n      ...(props.enableJsApi && typeof window !== 'undefined' ? { origin: window.location.origin } : {}),\n      ...(props.playlist ? { list: videoId } : {}),\n    });\n\n    // parse props.params into individual search parameters and append them to params\n    if (props.params) {\n      const additionalParams = new URLSearchParams(\n        props.params.startsWith(\"&\") ? props.params.slice(1) : props.params\n      );\n      additionalParams.forEach((value, key) => {\n        params.append(key, value);\n      });\n    }\n\n    return params;\n  }, [\n    props.muted,\n    shouldAddAutoplayParam,\n    props.enableJsApi,\n    props.playlist,\n    videoId,\n    props.params,\n  ]);\n\n  const ytUrl = React.useMemo(\n    () =>\n      props.cookie\n        ? \"https://www.youtube.com\"\n        : \"https://www.youtube-nocookie.com\",\n    [props.cookie]\n  );\n\n  const iframeSrc = React.useMemo(\n    () =>\n      !props.playlist\n        ? `${ytUrl}/embed/${videoId}?${iframeParams.toString()}`\n        : `${ytUrl}/embed/videoseries?${iframeParams.toString()}`,\n    [props.playlist, ytUrl, videoId, iframeParams]\n  );\n\n  const useDynamicThumbnail =\n    !props.thumbnail && !props.playlist && posterImp === \"maxresdefault\";\n\n  const format = props.webp ? \"webp\" : \"jpg\";\n  const vi = props.webp ? \"vi_webp\" : \"vi\";\n\n  const dynamicThumbnailUrl = useDynamicThumbnail\n    ? useYoutubeThumbnail(props.id, vi, format, posterImp)\n    : null;\n\n  const posterUrl = React.useMemo(\n    () =>\n      props.thumbnail ||\n      dynamicThumbnailUrl ||\n      `https://i.ytimg.com/${vi}/${\n        props.playlist ? videoPlaylistCoverId : videoId\n      }/${posterImp}.${format}`,\n    [\n      props.thumbnail,\n      dynamicThumbnailUrl,\n      vi,\n      props.playlist,\n      videoPlaylistCoverId,\n      videoId,\n      posterImp,\n      format,\n    ]\n  );\n\n  const activatedClassImp = props.activatedClass || \"lyt-activated\";\n  const adNetworkImp = props.adNetwork || false;\n  const aspectHeight = props.aspectHeight || 9;\n  const aspectWidth = props.aspectWidth || 16;\n  const iframeClassImp = props.iframeClass || \"\";\n  const playerClassImp = props.playerClass || \"lty-playbtn\";\n  const wrapperClassImp = props.wrapperClass || \"yt-lite\";\n  const onIframeAdded = React.useCallback(\n    props.onIframeAdded || function () {},\n    [props.onIframeAdded]\n  );\n  const rel = props.rel ? \"prefetch\" : \"preload\";\n  const ContainerElement = props.containerElement || \"article\";\n  const includeNoscriptFallback = props.noscriptFallback !== false; // Default to true\n\n  const warmConnections = () => {\n    if (preconnected) return;\n    setPreconnected(true);\n  };\n\n  const addIframe = () => {\n    if (iframe) return;\n    setIframe(true);\n  };\n\n  React.useEffect(() => {\n    if (iframe) {\n      onIframeAdded();\n\n      // Focus iframe if focusOnLoad is enabled and ref is available\n      if (props.focusOnLoad && typeof ref === \"object\" && ref?.current) {\n        ref.current.focus();\n      }\n    }\n  }, [iframe, onIframeAdded, props.focusOnLoad, ref]);\n\n  // Set up postMessage listener for YouTube player events\n  React.useEffect(() => {\n    // Only set up listener if iframe is loaded and we have event handlers\n    if (!iframe || !props.enableJsApi) {\n      return;\n    }\n\n    const hasEventHandlers =\n      props.onReady ||\n      props.onStateChange ||\n      props.onError ||\n      props.onPlay ||\n      props.onPause ||\n      props.onEnd ||\n      props.onBuffering ||\n      props.onPlaybackRateChange ||\n      props.onPlaybackQualityChange;\n\n    if (!hasEventHandlers) {\n      return;\n    }\n\n    let isReady = false;\n    let iframeLoaded = false;\n\n    const handleMessage = (event: MessageEvent) => {\n      // Verify origin is from YouTube\n      if (\n        event.origin !== \"https://www.youtube.com\" &&\n        event.origin !== \"https://www.youtube-nocookie.com\"\n      ) {\n        return;\n      }\n\n      let data: { event?: string; info?: YouTubeEvent[\"info\"] };\n      try {\n        data =\n          typeof event.data === \"string\" ? JSON.parse(event.data) : event.data;\n      } catch {\n        return; // Invalid JSON, ignore\n      }\n\n      // Handle different YouTube events\n      switch (data.event) {\n        case \"onReady\":\n          if (!isReady) {\n            isReady = true;\n            if (props.onReady) {\n              props.onReady({\n                videoId: props.id,\n                title: videoTitle,\n              });\n            }\n          }\n          break;\n\n        case \"infoDelivery\":\n          // YouTube's postMessage API sends state changes via infoDelivery events\n          // This is the primary mechanism for receiving state change notifications\n          if (data.info?.playerState !== undefined) {\n            const state = data.info.playerState as PlayerState;\n\n            // Call main onStateChange handler\n            if (props.onStateChange) {\n              props.onStateChange({\n                state,\n                currentTime: data.info.currentTime,\n                duration: data.info.duration,\n              });\n            }\n\n            // Call convenience handlers\n            switch (state) {\n              case PlayerState.PLAYING:\n                props.onPlay?.();\n                break;\n              case PlayerState.PAUSED:\n                props.onPause?.();\n                break;\n              case PlayerState.ENDED:\n                props.onEnd?.();\n                // Stop video to return to thumbnail and prevent related videos\n                if (\n                  props.stopOnEnd &&\n                  typeof ref === \"object\" &&\n                  ref?.current?.contentWindow\n                ) {\n                  ref.current.contentWindow.postMessage(\n                    '{\"event\":\"command\",\"func\":\"stopVideo\",\"args\":\"\"}',\n                    \"*\"\n                  );\n                }\n                break;\n              case PlayerState.BUFFERING:\n                props.onBuffering?.();\n                break;\n            }\n          }\n\n          // Handle playback rate changes\n          if (data.info?.playbackRate !== undefined) {\n            props.onPlaybackRateChange?.(data.info.playbackRate);\n          }\n\n          // Handle playback quality changes\n          if (data.info?.playbackQuality !== undefined) {\n            props.onPlaybackQualityChange?.(data.info.playbackQuality);\n          }\n          break;\n\n        case \"onStateChange\":\n          // Fallback: YouTube may send dedicated onStateChange events in some cases\n          // However, infoDelivery (above) is the primary mechanism observed\n          if (data.info?.playerState !== undefined) {\n            const state = data.info.playerState as PlayerState;\n\n            // Call main onStateChange handler\n            if (props.onStateChange) {\n              props.onStateChange({\n                state,\n                currentTime: data.info.currentTime,\n                duration: data.info.duration,\n              });\n            }\n\n            // Call convenience handlers\n            switch (state) {\n              case PlayerState.PLAYING:\n                props.onPlay?.();\n                break;\n              case PlayerState.PAUSED:\n                props.onPause?.();\n                break;\n              case PlayerState.ENDED:\n                props.onEnd?.();\n                // Stop video to return to thumbnail and prevent related videos\n                if (\n                  props.stopOnEnd &&\n                  typeof ref === \"object\" &&\n                  ref?.current?.contentWindow\n                ) {\n                  ref.current.contentWindow.postMessage(\n                    '{\"event\":\"command\",\"func\":\"stopVideo\",\"args\":\"\"}',\n                    \"*\"\n                  );\n                }\n                break;\n              case PlayerState.BUFFERING:\n                props.onBuffering?.();\n                break;\n            }\n          }\n          break;\n\n        case \"onError\":\n          if (data.info && \"errorCode\" in data.info) {\n            const errorCode = (data.info as { errorCode: number }).errorCode;\n            if (props.onError) {\n              props.onError(errorCode as PlayerError);\n            }\n          }\n          break;\n\n        case \"onPlaybackRateChange\":\n          if (data.info?.playbackRate !== undefined) {\n            props.onPlaybackRateChange?.(data.info.playbackRate);\n          }\n          break;\n\n        case \"onPlaybackQualityChange\":\n          if (data.info?.playbackQuality !== undefined) {\n            props.onPlaybackQualityChange?.(data.info.playbackQuality);\n          }\n          break;\n      }\n    };\n\n    window.addEventListener(\"message\", handleMessage);\n\n    // Request iframe to send events by posting \"listening\" message\n    // This tells YouTube player to start sending events\n    const timeouts: ReturnType<typeof setTimeout>[] = [];\n    const attemptListen = () => {\n      if (typeof ref === \"object\" && ref?.current?.contentWindow) {\n        ref.current.contentWindow.postMessage(\n          '{\"event\":\"listening\",\"id\":\"' + videoId + '\"}',\n          \"*\"\n        );\n      }\n    };\n\n    // Strategy: Wait for iframe load event, then send listening message\n    // This is more reliable than arbitrary delays\n    const handleIframeLoad = () => {\n      if (iframeLoaded) {\n        return;\n      }\n      iframeLoaded = true;\n\n      // Send initial listening message immediately when iframe loads\n      attemptListen();\n\n      // Also retry with delays as fallback for slower YouTube API initialization\n      // YouTube's player API needs additional time to initialize even after iframe loads\n      const delays = [100, 300, 600, 1200, 2400];\n      delays.forEach((delay) => {\n        timeouts.push(setTimeout(attemptListen, delay));\n      });\n    };\n\n    // Attach load event listener to iframe\n    if (typeof ref === \"object\" && ref?.current) {\n      ref.current.addEventListener(\"load\", handleIframeLoad);\n\n      // If iframe is already loaded, trigger immediately\n      // This handles race condition where load event fired before listener attached\n      if (ref.current.contentDocument?.readyState === \"complete\") {\n        handleIframeLoad();\n      }\n    } else {\n      // Fallback: If ref not ready, use longer delays\n      const fallbackDelays = [200, 500, 1000, 2000, 3000];\n      fallbackDelays.forEach((delay) => {\n        timeouts.push(setTimeout(attemptListen, delay));\n      });\n    }\n\n    return () => {\n      window.removeEventListener(\"message\", handleMessage);\n      timeouts.forEach(clearTimeout);\n\n      // Clean up iframe load listener\n      if (typeof ref === \"object\" && ref?.current) {\n        ref.current.removeEventListener(\"load\", handleIframeLoad);\n      }\n    };\n  }, [\n    iframe,\n    props.enableJsApi,\n    props.onReady,\n    props.onStateChange,\n    props.onError,\n    props.onPlay,\n    props.onPause,\n    props.onEnd,\n    props.onBuffering,\n    props.onPlaybackRateChange,\n    props.onPlaybackQualityChange,\n    props.stopOnEnd,\n    props.id,\n    videoId,\n    videoTitle,\n    ref,\n  ]);\n\n  return (\n    <>\n      {!props.lazyLoad && <link rel={rel} href={posterUrl} as=\"image\" />}\n      <>\n        {preconnected && (\n          <>\n            <link rel=\"preconnect\" href={ytUrl} />\n            <link rel=\"preconnect\" href=\"https://www.google.com\" />\n            {adNetworkImp && (\n              <>\n                <link rel=\"preconnect\" href=\"https://static.doubleclick.net\" />\n                <link\n                  rel=\"preconnect\"\n                  href=\"https://googleads.g.doubleclick.net\"\n                />\n              </>\n            )}\n          </>\n        )}\n      </>\n      {/* SEO: JSON-LD Structured Data for VideoObject */}\n      {props.seo && !props.playlist && (\n        <script\n          type=\"application/ld+json\"\n          dangerouslySetInnerHTML={{\n            __html: generateVideoStructuredData(\n              props.id,\n              videoTitle,\n              posterUrl,\n              ytUrl,\n              props.seo\n            ),\n          }}\n        />\n      )}\n      {/* SEO: Noscript fallback for accessibility and crawlers */}\n      {includeNoscriptFallback && !props.playlist && (\n        <noscript>\n          <a\n            href={`https://www.youtube.com/watch?v=${props.id}`}\n            aria-label={`Watch ${videoTitle} on YouTube`}\n          >\n            Watch &quot;{videoTitle}&quot; on YouTube\n          </a>\n        </noscript>\n      )}\n      <ContainerElement\n        onPointerOver={warmConnections}\n        onClick={addIframe}\n        className={`${wrapperClassImp} ${iframe ? activatedClassImp : \"\"}`}\n        data-title={videoTitle}\n        role={!iframe ? \"img\" : undefined}\n        aria-label={\n          !iframe ? `${videoTitle} - YouTube video preview` : undefined\n        }\n        style={\n          {\n            ...(!props.lazyLoad && { backgroundImage: `url(${posterUrl})` }),\n            \"--aspect-ratio\": `${(aspectHeight / aspectWidth) * 100}%`,\n            ...(props.style || {}),\n          } as React.CSSProperties\n        }\n      >\n        {props.lazyLoad && !iframe && (\n          <img\n            src={posterUrl}\n            alt={`${videoTitle} - YouTube thumbnail`}\n            className=\"lty-thumbnail\"\n            loading=\"lazy\"\n          />\n        )}\n        <button\n          type=\"button\"\n          className={playerClassImp}\n          aria-label={`${announceWatch} ${videoTitle}`}\n          aria-hidden={iframe || undefined}\n          tabIndex={iframe ? -1 : 0}\n          onClick={addIframe}\n        >\n          <span className=\"lty-visually-hidden\">{announceWatch}</span>\n        </button>\n        {iframe && (\n          <iframe\n            ref={ref}\n            className={iframeClassImp}\n            title={videoTitle}\n            width=\"560\"\n            height=\"315\"\n            allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"\n            allowFullScreen\n            src={iframeSrc}\n            referrerPolicy={\n              (props.referrerPolicy ||\n                \"strict-origin-when-cross-origin\") as React.HTMLAttributeReferrerPolicy\n            }\n          ></iframe>\n        )}\n      </ContainerElement>\n    </>\n  );\n}\n\nexport default React.forwardRef<HTMLIFrameElement, LiteYouTubeProps>(\n  LiteYouTubeEmbedComponent\n);\n"],"names":["expectedWidths","useYoutubeThumbnail","videoId","vi","format","imageRes","url","setUrl","useState","useEffect","testUrl","fallbackUrl","expectedWidth","img","PlayerState","PlayerError","generateVideoStructuredData","title","posterUrl","ytUrl","seo","structuredData","LiteYouTubeEmbedComponent","props","ref","preconnected","setPreconnected","React","iframe","setIframe","videoPlaylistCoverId","videoTitle","posterImp","announceWatch","shouldAddAutoplayParam","iframeParams","params","value","key","iframeSrc","useDynamicThumbnail","dynamicThumbnailUrl","activatedClassImp","adNetworkImp","aspectHeight","aspectWidth","iframeClassImp","playerClassImp","wrapperClassImp","onIframeAdded","rel","ContainerElement","includeNoscriptFallback","warmConnections","addIframe","isReady","iframeLoaded","handleMessage","event","data","state","errorCode","timeouts","attemptListen","handleIframeLoad","delay","jsxs","Fragment","jsx","index"],"mappings":"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"}